# Socket.io 遥控器服务器数据操作指令文档

本文档描述了遥控器与服务器之间的数据操作相关指令和响应。服务端地址为 `wss://gs.classtao.cn/all`，采用 WebSocket 协议。

当前日期：2025年4月20日  
文档版本：1.0  

---

## 目录

- [Socket.io 遥控器服务器数据操作指令文档](#socketio-遥控器服务器数据操作指令文档)
  - [目录](#目录)
  - [1. 接口概述](#1-接口概述)
  - [2. 数据操作指令](#2-数据操作指令)
    - [2.1 设置相机运动标记](#21-设置相机运动标记)
  - [3. 更新日志](#3-更新日志)
    - [v1.0 (2025年4月20日)](#v10-2025年4月20日)

---

## 1. 接口概述

遥控器与服务器之间的数据操作通信基于 Socket.io 协议，用于实现特定功能的数据传输和操作。这些接口遵循统一的通信格式和响应结构。

## 2. 数据操作指令

### 2.1 设置相机运动标记
- **描述**: 设置相机的运动识别标记点，用于人脸识别等体育测试项目。
- **事件**: `message`
- **请求格式**:
  ```typescript
  {
    action: "set_camera_sport_mark",
    from: "control_web",
    to: ["server"],
    time: number,
    data: {
      sportType: string,      // 运动类型，如："face_recognition"
      schoolId: string,       // 学校ID
      cameraId: string,       // 相机ID
      marks: Array<{          // 标记点坐标数组
        x: number,            // 横坐标
        y: number             // 纵坐标
      }>,
      createdAt: string,      // 创建时间，ISO格式
      imageUrl: string        // 图像URL
    }
  }
  ```

- **实际请求示例**:
  ```javascript
  {
    action: "set_camera_sport_mark",
    from: "control_web",
    to: ["server"],
    time: 1745246677908,
    data: {
      sportType: "face_recognition",
      schoolId: "677a9558d384497a599fb89f",
      cameraId: "67f890cbd73e2275241ad9db",
      marks: [
        {x: 968, y: 558}, {x: 1068, y: 627},
        {x: 611, y: 579}, {x: 702, y: 651},
        {x: 231, y: 583}, {x: 309, y: 651},
        {x: 961, y: 402}, {x: 1031, y: 453},
        {x: 703, y: 411}, {x: 759, y: 483},
        {x: 418, y: 435}, {x: 487, y: 491},
        {x: 149, y: 438}, {x: 222, y: 493}
      ],
      createdAt: "2025-04-21T14:44:37.319Z",
      imageUrl: "http://zhihuicaochang.oss-cn-hangzhou.aliyuncs.com/sports/face_recognition/677a9558d384497a599fb89f/1745246677324_7991.jpg"
    }
  }
  ```

- **响应格式**:
  ```typescript
  {
    action: "set_camera_sport_mark_response",
    status: "success" | "error",
    message: string,
    data: {
      updated: boolean        // 是否设置成功
    }
  }
  ```

## 3. 更新日志

### v1.0 (2025年4月20日)
- 初始版本发布
- 支持相机运动标记设置 